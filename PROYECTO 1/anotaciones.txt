que es vlans?

los vlans son areas de trabajo locales virtuales, estas son 
redes logicas que se pueden crear dentro de un swicth para 
separa y organizar los dispositivos que estan conectados
son como que fueran otros cables pero fisicamente estan el mismo
hardware.

Explicandolo mas sencilla mente una vlan se usa para crear subredes
virtuales dentro de un switch, cada vlan creada actua
como si fuera una red independiente.


los comandos basicos para crear una Vlan 
enable
configure terminal
######
enable
configure terminal

vlan 17
 name Redaccion_Digital
exit

vlan 27
 name Analisis_Datos
exit

vlan 37
 name Infraestructura_IT
exit

vlan 47
 name Seguridad
exit

vlan 57
 name Gerencia
exit

################################

luego se asignan valores para cada vlan con los siguientes comandos



interface fa0/2                  es el puerto que permite usar la vlan
 switchport mode access          se pone en modo acceso
 switchport access vlan 17       le da acceso a la vlan


###############################


##########################################
Que es un VTP?
una Vtp (Vlan Trunking Protocolo) esto es un protocolo de cisco
que sirve para administrar de manera centralizada 
las vlans en una red con varios swicthes

mas simple 
con VTP es el comando con el que se borra, crea o se renombra una
vlan en el switch servidor, automaticamente se replica la informacion
a todos los switches clientes que esten en el mismo dominio VTP

############################################
swtich servidor
comandos para usar VTP
enable
configure terminal
vtp domain FIUComm
vtp mode server
vtp password proyecto12025


swtich cliente 
enable
configure terminal
vtp domain FIUComm
vtp mode client
vtp password proyecto12025
################################################'




vlan 15 
    name RedaccionDigital






########################################################################################################

que es STP?
STP (Spanning Tree Protocol) es un protocolo que se usa en swicthes
para evitar bucles de red cuando hay enlaces redundantes 

en una definicion mas simple cuando se conecta a un switches con mas
de un caminmo para redundantes pueden formarse bucles
Los paquetes viajan en círculo infinito.

Se satura la red con broadcasts (tormenta de broadcast).

Se cae toda la comunicación.
STP soluciona esto:
Detecta los caminos redundantes.
Elige el mejor camino principal.
Bloquea temporalmente los enlaces sobrantes.
Si el enlace principal falla, desbloquea automáticamente otro para mantener la red activa.

comandos basicos para usar STP
enable
configure terminal
spanning-tree mode pvst
spanning-tree vlan 1 priority 4096
spanning-tree mode rapid-pvst

######################################################################################################


comandos para agrupar etherchanel con cisco 

que es etherchanel?

etherchanel es una tecnologia de cisco que permite agrupar varios enlaces
fisicos de red (interfaces) en un solo enlace logico 

puedo combinar 2,3 o mas puertos fastEthernets o gigabitEthernet 
entre swicthes o servidores 

se suman las velocidades segun los puerto que combine se aumenta
ancho de banda

los protocolos son:
PAgp este significa Port Agregation Protocolo  este es propio de cisco
y 
LACP este significa Link Agregation Control Protocolo 
este es estandar y es compatible con mas fabricantes

######################################################
protocolo con PAgp
enable
configure terminal

! Seleccionamos los 3 puertos que harán parte del EtherChannel
interface range fa0/1 - 3  es el rango de los puertos
 switchport mode trunk
 channel-group 1 mode desirable
exit
#######################################################


###########################################################
protocolo con LACP
enable
configure terminal

interface range fa0/1 - 3   es el rango de los puertos 
 switchport mode trunk      
 channel-group 2 mode active
exit


comandos de verificacion 
show etherchannel summary
show running-config
show vtp status
show vlan brief

###########################################################













* configuracion de Switch Servidor

```
enable 
configure terminal 
    vtp domain C5_FIUCom
    vtp mode server
    vtp password proyecto12025    (lo agrego al final)

    ! configuracion de vlans 
    vlan 18  
    name RedaccionDigital
    exit
    vlan 28
    name AnalisisDatos
    exit
    vlan 38
    name InfraestructuraIT
    exit
    vlan 48
    name Seguridad
    exit
    vlan 58
    name Gerencia
    exit
  

    !configuracion stp
    spanning-tree mode pvst                            ! activa el protocolo PVST un arbol stp por cada vlan
    spanning-tree vlan 18,28,38,48,58 priority 4095    ! Fuerza a este switch como root bridge bajando priorida a 4096

    ! ETHERCHANNEL ROJO hacia MSW6 (LACP)
    !configuracion de EtherChannels

    interface port-channel 1               ! Primero se configura el port-channel
    switchport trunk encapsulation dot1q   ! Requiere establecer encapsulación antes de modo trunk
    switchport mode trunk
    switchport trunk allowed vlan 18,28,38,48,58
    exit

    interface range fa0/6 - 8              ! Luego se agrego las interfaces físicas
    switchport trunk encapsulation dot1q   ! ← Define el protocolo de etiquetado para tramas VLAN (IEEE 802.1Q)
    channel-group 1 mode active            ! LACP (modo activo)
    exit


    ! ETHERCHANNEL ROJO hacia MSW5 (LACP)

    interface port-channel 2
    switchport trunk encapsulation dot1q            ! ← Define el protocolo de etiquetado para tramas VLAN (IEEE 802.1Q)
    switchport mode trunk                           ! ← Establece que este puerto será un enlace troncal (pasa múltiples VLANs)
    switchport trunk allowed vlan 18,28,38,48,58
    exit

    interface range fa0/10 - 12
    switchport trunk encapsulation dot1q
    channel-group 2 mode active
    exit
  


     ! configuracion Etherchanel verde hacia MSW1 LACP
    interface port-channel 3
    switchport trunk encapsulation dot1q
    switchport mode trunk
    switchport trunk allowed vlan 18,28,38,48,58
    exit
  
    interface range fa0/13 - 15
    switchport trunk encapsulation dot1q
    channel-group 3 mode active   
    exit


    !configuracion Etherchannel azul hacia msw3 PAgp
    interface port-channel 4
    switchport trunk encapsulation dot1q
    switchport mode trunk
    switchport trunk allowed vlan 18,28,38,48,58
    exit

    interface range fa0/19 - 21
    switchport trunk encapsulation dot1q
    channel-group 4 mode desirable  
    exit
    !fin

    ! configuracion Etherchanel verde hacia msw2 LACP
    interface port-channel 5
    switchport trunk encapsulation dot1q
    switchport mode trunk
    switchport trunk allowed vlan 18,28,38,48,58

    exit

    interface range fa0/16 - 18
    switchport trunk encapsulation dot1q
    channel-group 5 mode active         ! ← LACP = active
    exit

    ! fin

    !configuracion Etherchannel azul hacia msw4 PAgp
    interface port-channel 6
    switchport trunk encapsulation dot1q
    switchport mode trunk
    switchport trunk allowed vlan 18,28,38,48,58
    exit

    interface range fa0/22 - 24
    switchport trunk encapsulation dot1q
    channel-group 6 mode desirable      ! ← PAgP = desirable
    exit
    !fin
```

* configuracion de Switch MSW6 (cliente)

```
    enable 
    configure terminal 

    !configuracion VTP

     vtp domain C5_FIUComm

    vtp mode client


    !stp 
    spanning-tree mode pvst


    !configuracion Etherchanel rojo hacia Servidor
    interface port-channel 1
    switchport trunk encapsulation dot1q
    switchport mode trunk
    switchport trunk allowed vlan 18,28,38,48,58 
    exit

    interface range fa0/6 - 8
    switchport trunk encapsulation dot1q
    channel-group 1 mode active         ! ← LACP = active
    exit  

    ! fin 


    ! configuracion Etherchanel verde hacia msw1 LACP
    interface port-channel 2
    switchport trunk encapsulation dot1q
    switchport mode trunk
    switchport trunk allowed vlan 18,28,38,48,58

    exit

    interface range fa0/10 - 12
    switchport trunk encapsulation dot1q
    channel-group 2 mode active         ! ← LACP = active
    exit

    ! fin





    !configuracion Etherchannel azul hacia msw3 PAgp
    interface port-channel 3
    switchport trunk encapsulation dot1q
    switchport mode trunk
    switchport trunk allowed vlan 18,28,38,48,58
    exit

    interface range fa0/13 - 15
    switchport trunk encapsulation dot1q
    channel-group 3 mode desirable      ! ← PAgP = desirable
    exit
    !fin



```

* configuracion de Switch MSW1 (cliente)

```
enable 
    configure terminal 

    !configuracion VTP
    vtp domain C5_FIUComm
    vtp mode client

    !stp 
    spanning-tree mode pvst

    ! configuracion Etherchanel verde hacia msw6 LACP
    interface port-channel 1
    switchport trunk encapsulation dot1q
    switchport mode trunk
    switchport trunk allowed vlan 18,28,38,48,58
    exit

    interface range fa0/10 - 12
    switchport trunk encapsulation dot1q
    channel-group 1 mode active   
    exit
    ! fin

    ! configuracion Etherchanel verde hacia servidor LACP
    interface port-channel 2
    switchport trunk encapsulation dot1q
    switchport mode trunk
    switchport trunk allowed vlan 18,28,38,48,58
    exit

    interface range fa0/13 - 15
    switchport trunk encapsulation dot1q
    channel-group 2 mode active   
    exit
! fin
```

* configuracion de Switch MSW5 (cliente)

```
enable 
    configure terminal 

    !configuracion VTP
    vtp domain C5_FIUCom
    vtp mode client

    !stp 
    spanning-tree mode pvst


    !configuracion Etherchanel rojo hacia Servidor
    interface port-channel 1
    switchport trunk encapsulation dot1q
    switchport mode trunk
    switchport trunk allowed vlan 18,28,38,48,58 
    exit

    interface range fa0/10 - 12
    switchport trunk encapsulation dot1q
    channel-group 1 mode active         ! ← LACP = active
    exit  

```